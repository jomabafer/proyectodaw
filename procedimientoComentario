DROP PROCEDURE IF EXISTS COMENTAR;
DELIMITER $$

CREATE PROCEDURE COMENTAR(IN IDUSUARIO INT, IN IDPUBLICACION INT, IN FHCOMENTARIO DATETIME, IN CONTENIDO LONGTEXT)
BEGIN
    DECLARE IDNUEVOCOMENTARIO INT DEFAULT 0;
    
    START TRANSACTION;
    INSERT INTO COMENTARIOPUBLICACIÃ“N (`idUsuario`, `idPublicacion`, `fHcomentario`, `contenido`) VALUES (IDUSUARIO, IDPUBLICACION, FHCOMENTARIO, CONTENIDO);   
    SET IDNUEVOCOMENTARIO = LAST_INSERT_ID();
    IF IDNUEVOCOMENTARIO > 0 THEN
    INSERT INTO NOTIFICACIONCOMENTARIO (`identComentario`, `idUsuario`, `idPublicacion`) VALUES (IDNUEVOCOMENTARIO, IDUSUARIO, IDPUBLICACION);
    COMMIT;
    ELSE
    ROLLBACK;
    END IF;
END$$
 
DELIMITER ;
